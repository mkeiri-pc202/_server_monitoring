# サーバモニタリング 仕様書

バージョン: 1.0  
作成日: [2025/10/20]  
作成者: [作成者名 / 松本経理ビジネス専門学校 Team A ]  
リポジトリ: [mkeiri-pc202/_server_monitoring](https://github.com/mkeiri-pc202/_server_monitoring)

---

## 1. 概要
松本経理ビジネス専門学校の職業訓練の一環として、Pythonを使用したプログラムの作成を通じて、プログラミングの理解を深めることを目的として作成する

### 1.1 目的
- サーバモニタリング機能の動作を目的として作成する
  
---

## 2. 用語定義
- サーバモニタリング：サーバの稼働状況を継続的に確認し、異常を早期に検知・対処すること
- 稼働状況:監視対象のメモリ、CPU、HDDの利用率を指す
- 閾値:メモリ、CPU、HDDの稼働状況に応じてアラートを出す境界値を指す
- DB:データベースを指す
  
---

## 3. 高レベル要件（目的・目標）
- 正確さ: 標準的な数値表現で結果を表示する
- 機能: 監視対象の異常発生時に検知できる仕組みを作成する
- 構成: サーバモニタリング用の端末1台、監視対象は1台以上とする

---

## 4. 機能要件

### 4.1 基本機能
-　監視対象から監視アプリに対して稼働状況を送信する
-　サーバモニタリング用の端末のWebServiceを使って、監視対象からの通知ログを確認する

### 4.2 追加機能
-　利用状況事に設定した閾値を超えた場合、監視対象からメールで通知を行う
-　結果表示画面から表示件数、監視対象のサーバ名、日付の絞り込みを行う
-　サーバ名を選択時に各利用状況のグラフを表示させる

### 4.3 非機能要件
- データ送信の頻度: 監視対象からの送信頻度は5分～10分のインターバルをとるものとする
- データの送信方法: 社内利用を想定し、電文は平文（HTTP)での送信とする

---

## 5. ユーザーインターフェース（UI / UX）
- HTML、Bootstrup、CSS、jQueryを使用して作成した

### 5.1 コマンドライン (CLI)
- 起動方法:DockerからPythonを起動し、app.pyを実行する

### 5.2 GUI / Web
- 起動方法:GUIでの起動は想定していない。
- 
  
---

## 6. データ送受信仕様

### 6.1 送信形式
- POSTを利用し、Json形式で監視対象からサーバモニタリング用の端末にデータを送付する

### 6.2 出力形式
-    data = {
        'server_id': hostname,
        'cpu': cpu,
        'memory': memory,
        'disk_free_gb': disk
    }

### 6.2 受信形式
-　監視対象から受信したデータをDBに保存する

### 6.3 表示形式
-　サーバモニタリング用の端末に対してアクセスがあった際に、利用するデータをクエリで取得後、HTML形式で表示を行う
-　履歴と表示の選択項目に基づいてグラフを作成する

---

## 7. エラー処理とメッセージ
- HTMLのアラートを使ってエラーを通知する

---

## 8. 内部設計（アーキテクチャ）
- モジュール構成
  - app.py(WebService起動用のプログラムのまとめ）
  - config.py(データベースのファイルの保存先を指定）
  - filter.py(Flaskのフィルタリング機能の設定）
  - models.py(DB名、カラムの指定)
  - views.py(データ受信、メインページの表示、グラフの出力などの関数を設定）

- client(監視対象用のプログラムを保存しているフォルダ)
  - client.py(データ送信用プログラムの起動）
  - send_e_mail.py(利用状況の閾値を超えた際のメール送信の設定)

- instance（DBの保存場所）
  - server_status.sqlite
- templates(HTMLファイルの保存場所）
  - base.html
  - index.html

### 9.1 データフロー（簡易）
- データの送受信
  - 監視対象からサーバモニタリング用の端末にデータを送信 → サーバモニタリング用の端末で受信　→ サーバモニタリング用の端末内に受信したデータを保存

- データの表示
　- クライアントからサーバモニタリング用の端末にHTML形式でアクセス →　HTMLの画面を送信する → クライアントのブラウザで表示を行う
  
---

## 10. テスト計画
- ユニットテスト（単体テスト）
  - 機能別の演算の正しさテスト
  　
 
- 統合テスト
  - なし（フローが単純なのでユニットテストで網羅できてしまうため）
    
- 回帰テスト
  - なし

---

## 11. 受け入れ基準
- 定義された基本機能が全て正常に動作すること
- 重大なエラー（クラッシュ、未処理例外）がないこと
- 仕様書が整備されていること

---

## 12. ロードマップ / バージョニング
- V1.0
- 監視対象から監視アプリに対して稼働状況を送信する
- サーバモニタリング用の端末のWebServiceを使って、監視対象からの通知ログを確認する

- 今後のバージョンアップは未定（職業訓練の過程修了のため）
---

## 13. ビルド・実行方法
- OS	Windows 11
- 言語 / Python 3.13
- 使用ツール	VSCode
- フレームワーク	Python 3.10 / flask 2.3.2 / flask_migrate 4.0.4/  flask_sqlalchemy 3.0.3 / matplotlib 3.10.6 / anaconda
- 仮想環境	Anaconda(conda 24.9.2)

---

## 14. セキュリティと注意点
- 社内利用を前提としているので平文でやり取りしている

---

（終わり）
